import React, { useEffect, useState } from 'react';
import {
  IonBackButton,
  IonButtons,
  IonContent,
  IonHeader,
  IonPage,
  IonTitle,
  IonToolbar
} from '@ionic/react';
import { useParams } from 'react-router-dom';

interface TxScreenParams {
  id: string;
}

const online_escrow = `Онлайн-сделка: мгновенная передача собственности — просто, надежно, без границ

В современную цифровую эпоху процесс передачи прав собственности стал значительно проще и быстрее. Благодаря технологии онлайн-сделки процедура может быть завершена всего за один день — без длительных ожиданий, сложных бюрократических процедур и необходимости обращения к посредникам. Это эффективный и прозрачный способ перехода прав на недвижимость в электронном формате.

Этапы проведения сделки:
1. Выбор объекта — определите подходящий участок или согласуйте условия с другой стороной сделки.
2. Оформление документов — все действия выполняются в электронном виде, без личного присутствия.
3. Подписание и регистрация — документы подписываются электронной подписью, после чего право собственности регистрируется мгновенно.
4. Завершение сделки — в течение одного рабочего дня происходит переход права собственности.

Преимущества онлайн-сделки:
• Оперативность — завершение сделки в течение 24 часов.
• Безопасность — соблюдение всех юридических норм и защита прав сторон.
• Удобство — полный процесс осуществляется дистанционно.
• Экономичность — снижение сопутствующих расходов за счёт автоматизации.

Онлайн-сделка — это современное решение, позволяющее передавать права собственности быстро, эффективно и безопасно.`;

const save_deal = `Безопасная сделка (Escrow) в Stalcraft

Как это работает

При приобретении игровых ценностей в Stalcraft — таких как артефакты, ресурсы, аккаунты или услуги — важно обеспечить защиту от возможного мошенничества. Механизм безопасной сделки (Escrow) гарантирует честный и прозрачный процесс обмена между сторонами:
1. Покупатель переводит денежные средства в систему — средства временно замораживаются.
2. Продавец передаёт товар или оказывает услугу (например, артефакт, ресурс или игровую помощь) и подтверждает выполнение обязательств.
3. Покупатель проверяет результат и подтверждает получение — средства автоматически перечисляются продавцу.

Преимущества Escrow
• Для покупателя: средства переводятся продавцу только после подтверждения получения товара или услуги.
• Для продавца: наличие гарантии оплаты — деньги резервируются до завершения сделки.

Все платежи обрабатываются через ЮKassa, обеспечивающую безопасность и юридическую чистоту финансовых операций.`;

const TxScreen: React.FC = () => {
  const { id } = useParams<TxScreenParams>();
  const [text, setText] = useState<string>('Загрузка...');
  const [loading, setLoading] = useState<boolean>(true);

  const fetchText = async (id: string) => {
    try {
      setLoading(true);

      const rawText =
        id === '1'
          ? online_escrow
          : id === '2'
            ? save_deal
            : 'Текст для другого ID не найден.';

      // Преобразуем текст в абзацы <p>
      const formattedText = rawText
        .split('\n')
        .filter(line => line.trim())
        .map(line => `<p>${line}</p>`)
        .join('');

      setText(formattedText);
    } catch (error) {
      console.error('Ошибка загрузки текста:', error);
      setText('<p>Ошибка загрузки текста.</p>');
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    if (id) {
      fetchText(id);
    }
  }, [id]);

  return (
    <IonPage>
      <IonHeader>
        <IonToolbar>
          <IonButtons slot="start">
            <IonBackButton defaultHref="/" />
          </IonButtons>
          <IonTitle>#{id}</IonTitle>
        </IonToolbar>
      </IonHeader>
      <IonContent className="ion-padding">
        <div style={{ padding: '16px' }}>
          {loading ? (
            <p>Загрузка...</p>
          ) : (
            <div
              className="text-content"
              dangerouslySetInnerHTML={{ __html: text }}
            />
          )}
        </div>
      </IonContent>
    </IonPage>
  );
};

export default TxScreen;